[project]
name = "agentic-neurodata-conversion"
version = "0.1.0"
description = "AI-assisted neurodata conversion to NWB format using multi-agent architecture"
authors = ["Aditya Patane <aditya@example.com>"]
channels = ["conda-forge"]
platforms = ["osx-arm64", "linux-64"]

[dependencies]
python = "3.13.*"
fastapi = ">=0.115.0"
uvicorn = ">=0.32.0"
pydantic = ">=2.9.0"
reportlab = ">=4.2.5"
jinja2 = ">=3.1.4"
pytest = ">=8.3.3"
pytest-cov = ">=6.0.0"
pytest-asyncio = ">=0.24.0"
pytest-timeout = ">=2.2.0"
pytest-mock = ">=3.12.0"
httpx = ">=0.27.2"
pyyaml = ">=6.0.2"
numpy = ">=2.1.3"
h5py = ">=3.12.1"
pre-commit = ">=4.3.0,<5"
hypothesis = ">=6.0.0"
types-python-dateutil = ">=2.9.0.20251108,<3"

[pypi-dependencies]
neuroconv = ">=0.6.3"
pynwb = ">=2.8.2"
nwbinspector = ">=0.4.36"
anthropic = ">=0.39.0"
websockets = ">=13.1"
spikeinterface = ">=0.101.0"
python-dotenv = ">=1.0.0"

[tasks]
# Development tasks
dev = "sh -c 'cd backend/src && uvicorn api.main:app --reload --host 0.0.0.0 --port 8000'"

# Test tasks
test = "pytest 'test scripts' -v"
test-cov = "pytest 'test scripts' -v --cov=backend/src --cov-report=term-missing --cov-report=html"
test-unit = "pytest 'test scripts/unit' -v"
test-integration = "pytest 'test scripts/integration' -v"
test-critical = "pytest 'test scripts' -v -m critical"
test-fast = "pytest 'test scripts' -v -m 'not slow and not llm'"
test-smoke = "pytest 'test scripts' -v -m smoke"

# Code quality tasks
lint = "ruff check backend/ 'test scripts/'"
format = "ruff format backend/ 'test scripts/'"
typecheck = "mypy backend/src"
precommit = "sh -c 'pixi run lint && pixi run format && pixi run typecheck && pixi run test'"

# Utility tasks
generate-fixtures = "python 'test scripts/fixtures/generate_toy_dataset.py'"
clean = "rm -rf backend/src/__pycache__ 'test scripts/__pycache__' .pytest_cache .coverage htmlcov coverage.xml"
serve = "python run_server.py"

[feature.dev.dependencies]
ruff = ">=0.14.4"
mypy = ">=1.18.2"
bandit = ">=1.7.6"
pydocstyle = ">=6.3.0"
pytest-xdist = ">=3.5.0"
ipython = ">=8.29.0"

[environments]
default = {features = ["dev"], solve-group = "default"}
